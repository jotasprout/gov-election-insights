!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],b):a.bsp_utils=b(a.jQuery)}(this,function(a){var b={};return function(){b.throttle=function(b,c){if(b<=0)return c;var d,e,f=0;return function(){if(e=arguments,!d){var g=this,h=+a.now(),i=b-h+f;i<=0?(f=h,c.apply(g,e)):d=setTimeout(function(){f=h,d=null,c.apply(g,e)},i)}}}}(),function(){b.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||b.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,a),h&&b.apply(e,f)}}}(),function(){function c(b){var c=b.insertedClassName,d=b.$roots.find(b.selector).filter(":not(."+c+")");if(d.length>0){d.addClass(c);var e=b.callbacks,f=e.beforeInsert,g=e.insert,h=e.afterInsert;f&&f(a.makeArray(d)),g&&d.each(function(){g(this)}),h&&h(a.makeArray(d))}}function d(){a.each(e,function(a,b){c(b)})}var e=[],f=0;b.onDomInsert=function(b,d,g){var h="bsp-onDomInsert-inserted-"+f;++f;var i={$roots:a(b),insertedClassName:h,selector:d,callbacks:g};a(document).ready(function(){c(i)}),e.push(i)};var g=window.MutationObserver||window.WebKitMutationObserver;a(document).ready(function(){g?new g(b.throttle(1,d)).observe(document,{childList:!0,subtree:!0}):setInterval(d,1e3/60)})}(),function(){var c=/\S+/g,d="_options",e=a(document);b.plugin=function(f,g,h,i){function j(b){return a.map(b.match(c),function(a){return a+"."+l._name}).join(" ")}function k(b,c){var e=b.attr(l._optionsAttrName);l._data(b[0],d,e?a.extend(!0,{},c,a.parseJSON(e)):c)}var l=i||{};return l._name=g+"_"+h,l._classNamePrefix=g+"-"+h+"-",l._rootClassName=l._classNamePrefix+"root",l._itemClassName=l._classNamePrefix+"item",l._on=function(b,c,d,e,f){var g=a(b);c=j(c),f?g.on(c,d,e,f):e?g.on(c,d,e):g.on(c,d)},l._off=function(b,c,d){var e=a(b);d?e.off(j(c),d):c?e.off(j(c)):e.off("."+l._name)},l._dataKeyPrefix=g+"-"+h+"-",l._data=function(b,c,d){var e=a(b);return 0===e.length?null:(c=l._dataKeyPrefix+c,void 0===d?a.data(e[0],c):e.each(function(){a.data(this,c,d)}))},l.option=function(b,c,e){var f=this;return void 0===c?f._data(b,d)||{}:void 0===e?(f._data(b,d)||{})[c]:(a(b).each(function(){var a=f._data(this,d);a||(a={},f._data(this,d,a)),a[c]=e}),null)},l._attrName="data-"+g+"-"+h,l._attrNamePrefix=l._attrName+"-",l._optionsAttrName=l._attrNamePrefix+"options",l.live=function(c,d,e){var f=a(c);if(0!==f.length){f.each(function(){var b=a(9===this.nodeType?this.documentElement:this);b.addClass(l._rootClassName),k(b,a.extend(!0,{},l._defaultOptions,e))});var g=l._init,h=l._each,i=l._all;g&&g.call(l,a.makeArray(f),d),(h||i)&&d&&b.onDomInsert(a.makeArray(f),d,{insert:function(b){var c=a(b),d=l.option(c.closest("."+l._rootClassName));c.addClass(l._itemClassName),k(c,d),h&&h.call(l,b)},afterInsert:i?function(a){i.call(l,a)}:a.noop})}},l.init=function(a,b){l.live(a,null,b)},l._install&&l._install(),e.ready(function(){l.live(document,"["+l._attrName+"]")}),f&&(f[l._name]=l),l}}(),b}),function(a){function b(){n.find("[data-watch-submit]").on("change",function(b){a(this).closest("form").find("[data-watch-submit-target]").trigger("click")})}function c(){n.frame({setBody:function(b){var c=a(this).attr("data-insertion-mode");"append"===c?a(this).append(b):"prepend"===c?a(this).prepend(b):a(this).html(b)}}).ready(function(){a(this).trigger("create")})}function d(){bsp_utils.onDomInsert(m,".segment-overlay",{insert:function(b){var c=a(b);c.find(".segment-overlay-close").on("click",function(){c.remove()})}})}function e(){n.find("#staffFilter").on("change",function(){var b=a(this).find("option:selected"),c=a(b).val(),d=a(b).data("parent"),e=a(b).data("name"),f=a(".staff-group."+d);a(".staff-list.changeable, .staff-header .title.changeable h3").html(""),a(".staff-group.dynamic, .vcard.filterable, .staff-header .title").hide(),0==f.length&&(f=a(".staff-group."+c)),a(f).find(".vcard.filterable."+c).clone().appendTo(".staff-list.changeable"),a(".staff-group.dynamic:first, .staff-list.changeable, .staff-header .title.changeable, .staff-list.changeable .vcard").show(),a(".staff-header .title.changeable h3").html(e),"all"==c&&(a(".staff-header .title, .vcard.filterable, .staff-group.dynamic").removeAttr("style"),a(".staff-list.changeable").hide())})}function f(){n.find(".simple-submit button[type='submit']").on("click",function(){a(".simple-submit [required]").each(function(){a(this)[0].checkValidity()?a(this).removeClass("contains-error"):a(this).addClass("contains-error")})}),n.find(".simple-submit").on("submit",function(b){b.preventDefault();var c=a(".simple-submit").serialize();a.ajax({url:a(".simple-submit").attr("action"),type:"POST",data:c,dataType:"json",success:function(b){"error"==b.result?a(".system-alert.type-error").removeAttr("style"):"success"==b.result&&(a(".system-alert.type-error").hide(),a(".simple-submit fieldset").remove(),a(".system-alert.type-success").removeAttr("style").appendTo(".simple-submit"))}})})}function g(){n.on("click","[data-pol-click-hide]",function(){var b=a(this),c=b.closest("[data-pol-click-hide-target]");c.size(),c.hide()})}function h(){a("form[data-pol-blog-module]").on("change",function(b){var c=a(this);""===c.find("#blogArchives:selected").val()?b.preventDefault():c.submit()})}function i(){var b="//"+window.location.host+"/cgi-bin/subscribe",c=a('form[data-subscribe]>input[name="subscribeId"]').serializeArray();c.length>0&&(c.push({name:"action",value:"status"}),a.getJSON(b,c,function(b){if("success"===b.status){var c=b.data;a("form[data-subscribe]").each(function(b,d){var e=a(d),f=e.find('>input[name="subscribeId"]:first').attr("value");if(c[f]){var g=e.find("button.button:first"),h=g.find("span:first"),i=g.find("b.icon:first");g.removeClass("type-link"),g.addClass("type-gray"),h.text("Subscribed"),i.removeClass("icon-mail"),i.addClass("icon-check")}})}}))}function j(){var b=a(document).lazyLoader(),c=b.find("[data-lazy-img], .secondary-moments [data-lazy]"),d=b.data("plugin_lazyLoader");d.createCheckListeners(),d.addItems(c)}function k(){a(".newsletter-intro").length&&a(".global-wrapper .with-close-button#globalNewsletter").addClass("is-active")}function l(){a(".user-settings-policy .option-controls input").on("change",function(){var b=a(this).closest(".option-controls").find("input[value=custom]:checked").length;a(this).closest(".option-header").next(".option-groupset").toggleClass("disabled",!b>0)}).trigger("change")}var m=window.document,n=a(m);n.ready(function(){b(),c(),f(),e(),d(),i(),g(),h(),j(),l(),k()})}(jQuery);